<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Categorías de Productos</title>

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  font-family:Arial,sans-serif;
  background:url('../../images/plata.jpeg') no-repeat center center fixed;
  background-size:cover;
  color:#fff;
  overflow-x:hidden;
}

header{
  background:rgba(35,47,62,.95);
  color:#fff;
  padding:12px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  position:sticky;
  top:0;
  z-index:9999;
}

header h1{
  margin:0;
  color:#ffcc00;
  font-size:1.6em;
  text-shadow:0 0 10px #ffcc00;
}

nav a{
  color:#fff;
  text-decoration:none;
  padding:.5em 1em;
  background:#ff007f;
  border-radius:10px;
  margin-left:8px;
}

h2{text-align:center;margin-top:15px;}

.contenedor-categorias{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  margin:1em;
}

.oculto{display:none !important;}

.categoria-btn{
  background:#ff007f;
  color:#fff;
  padding:1em 2em;
  border-radius:16px;
  margin:8px;
  border:none;
  font-weight:bold;
  cursor:pointer;
  font-size:1em;
}

#video-anuncio{
  width:100%;
  max-height:380px;
  display:none;
  margin:10px auto;
  border-radius:12px;
}

#productos-lista{
  display:grid;
  gap:1.2em;
  padding:1.2em;
}

@media(min-width:1200px){#productos-lista{grid-template-columns:repeat(4,1fr);}}
@media(max-width:1199px){#productos-lista{grid-template-columns:repeat(2,1fr);}}
@media(max-width:600px){#productos-lista{grid-template-columns:1fr;}}

.producto{
  background:rgba(255,255,255,.9);
  padding:1em;
  border-radius:12px;
  text-align:center;
  color:#000;
}

.producto img{
  width:100%;
  height:170px;
  object-fit:cover;
  border-radius:10px;
}

.boton-descripcion{
  display:block;
  margin-top:10px;
  padding:.6em;
  background:#ff5722;
  color:#fff;
  border-radius:8px;
  text-decoration:none;
  font-weight:bold;
}

footer{
  background:rgba(35,47,62,.95);
  color:#fff;
  padding:1em;
  text-align:center;
  margin-top:auto;
}
</style>
</head>

<body>

<header>
  <h1>DRANGILS MORALES</h1>
  <nav>
    <a href="../../index.html">Inicio</a>
    <a href="../../opciones/contactogeneral1.html">Contacto</a>
    <a href="../../opciones/vercarrito.html">Carrito</a>
  </nav>
</header>

<h2 id="titulo-principal">Categorías de Productos</h2>

<div class="contenedor-categorias" id="categoria-container"></div>

<video id="video-anuncio" muted autoplay playsinline></video>

<h2 id="titulo-cat" style="display:none;"></h2>

<div id="productos-lista"></div>

<footer>© 2025 DRANGILS MORALES</footer>

<script>
const URL_JSON =
"https://raw.githubusercontent.com/luismorales2025/APP_2025_DRANGILSMORS./main/data/products.json";

/* VIDEOS POR CATEGORÍA (DEBEN COINCIDIR CON EL JSON) */
const videosCategorias = {
  calzado: "../../videos/calzado.mp4",
  ropa: "../../videos/ropa.mp4",
  joyeria: "../../videos/joyeria.mp4",
  plata: "../../videos/plata.mp4",
  catalogos: "../../anuncio1.mp4"
};

let productos = [];

fetch(URL_JSON)
  .then(resp => resp.json())
  .then(data => {
    productos = data;

    const categorias = [...new Set(data.map(p => p.category))];

    document.getElementById("categoria-container").innerHTML =
      categorias.map(cat =>
        `<button class="categoria-btn" onclick="mostrarCategoria('${cat}')">${cat}</button>`
      ).join("");
  })
  .catch(err => {
    console.error("Error cargando JSON:", err);
  });

function mostrarCategoria(cat){
  const video = document.getElementById("video-anuncio");
  const lista = document.getElementById("productos-lista");
  const titulo = document.getElementById("titulo-cat");

  document.getElementById("categoria-container").classList.add("oculto");
  document.getElementById("titulo-principal").style.display="none";

  lista.innerHTML="";
  titulo.style.display="none";

  const mostrarProductos = () => {
    video.style.display="none";
    titulo.style.display="block";
    titulo.textContent = "Categoría: " + cat;

    lista.innerHTML = productos
      .filter(p => p.category === cat)
      .map(p => `
        <div class="producto">
          <img src="${p.image}">
          <h3>${p.title}</h3>
          <p><b>Q${p.price}</b></p>
          <a class="boton-descripcion"
             href="../../opciones/descripcion.html?id=${p.id}">
             Ver descripción
          </a>
        </div>
      `).join("");
  };

  if (videosCategorias[cat]) {
    video.src = videosCategorias[cat];
    video.style.display = "block";
    video.load();
    video.play().catch(()=>{});
    video.onended = mostrarProductos;
  } else {
    mostrarProductos();
  }
}
</script>

</body>
</html>
