<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Categorías de Productos</title>

<style>
body{
  margin:0;
  min-height:100vh;
  font-family:Arial,sans-serif;
  background:url('../../images/plata.jpeg') no-repeat center center fixed;
  background-size:cover;
  color:#fff;
  overflow-x:hidden;
}

/* HEADER */
header{
  background:rgba(35,47,62,.95);
  padding:12px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  position:sticky;
  top:0;
  z-index:9999;
}

header h1{
  margin:0;
  color:#ffcc00;
  font-size:1.5em;
}

nav a{
  color:#fff;
  text-decoration:none;
  padding:.4em .8em;
  background:#ff007f;
  border-radius:8px;
  margin-left:6px;
  font-size:14px;
}

/* CATEGORÍAS */
.contenedor-categorias{
  display:flex;
  gap:10px;
  overflow-x:auto;
  padding:10px;
  background:#1e88e5;
  position:sticky;
  top:70px;
  z-index:999;
  transition:transform .3s ease;
}

.contenedor-categorias.ocultar{
  transform:translateY(-120%);
}

.categoria-btn{
  background:#00bcd4;
  color:#fff;
  padding:.5em 1em;
  border-radius:20px;
  border:none;
  font-weight:bold;
  cursor:pointer;
  white-space:nowrap;
}

/* VIDEO */
#video-anuncio{
  width:100%;
  max-height:300px;
  object-fit:cover;
  display:none;
}

/* PRODUCTOS */
#productos-lista{
  display:grid;
  gap:1em;
  padding:1em;
}

@media(min-width:1000px){
  #productos-lista{grid-template-columns:repeat(4,1fr);}
}
@media(max-width:999px){
  #productos-lista{grid-template-columns:repeat(2,1fr);}
}
@media(max-width:600px){
  #productos-lista{grid-template-columns:1fr;}
}

.producto{
  background:#fff;
  color:#000;
  border-radius:12px;
  padding:.8em;
  text-align:center;
}

.producto img{
  width:100%;
  height:160px;
  object-fit:cover;
  border-radius:10px;
}

.boton-descripcion{
  display:block;
  margin-top:8px;
  padding:.5em;
  background:#ff5722;
  color:#fff;
  border-radius:8px;
  text-decoration:none;
  font-weight:bold;
}

footer{
  background:rgba(35,47,62,.95);
  text-align:center;
  padding:1em;
}
</style>
</head>

<body>

<header>
  <h1>DRANGILS MORALES</h1>
  <nav>
    <a href="../../index.html">Inicio</a>
    <a href="../../opciones/contactogeneral1.html">Contacto</a>
    <a href="../../opciones/vercarrito.html">Carrito</a>
  </nav>
</header>

<div class="contenedor-categorias" id="categoria-container"></div>

<video id="video-anuncio" muted autoplay></video>

<div id="productos-lista"></div>

<footer>© 2025 DRANGILS MORALES</footer>

<script>
const URL_JSON =
"https://raw.githubusercontent.com/luismorales2025/APP_2025_DRANGILSMORS/main/data/products.json";

const videosCategorias = {
  "Calzado mexicano": "../../videos/calzado.mp4",
  "Plata": "../../videos/plata.mp4"
};

let productos = [];
let lastScroll = 0;

/* CARGAR JSON */
fetch(URL_JSON)
.then(res => res.json())
.then(data => {
  productos = data;

  const categorias = [...new Set(productos.map(p => p.category))];
  document.getElementById("categoria-container").innerHTML =
    categorias.map(c =>
      `<button class="categoria-btn" onclick="mostrarCategoria('${c}')">${c}</button>`
    ).join("");
})
.catch(err => console.error("Error JSON:", err));

/* MOSTRAR CATEGORÍA */
function mostrarCategoria(cat){
  const video = document.getElementById("video-anuncio");
  const lista = document.getElementById("productos-lista");

  lista.innerHTML = "";

  if(videosCategorias[cat]){
    video.src = videosCategorias[cat];
    video.style.display = "block";
    video.currentTime = 0;
    video.play();

    setTimeout(() => {
      video.style.display = "none";
      cargarProductos(cat);
    }, 3500);
  } else {
    cargarProductos(cat);
  }
}

/* PRODUCTOS */
function cargarProductos(cat){
  document.getElementById("productos-lista").innerHTML =
    productos.filter(p => p.category === cat)
    .map(p => `
      <div class="producto">
        <img src="${p.image}">
        <h4>${p.title}</h4>
        <p><b>Q${p.price}</b></p>
        <a class="boton-descripcion"
           href="../../opciones/descripcion.html?id=${p.id}">
           Ver descripción
        </a>
      </div>
    `).join("");
}

/* OCULTAR / MOSTRAR CATEGORÍAS AL SCROLL */
window.addEventListener("scroll", () => {
  const cont = document.getElementById("categoria-container");
  const actual = window.pageYOffset;

  if(actual > lastScroll){
    cont.classList.add("ocultar");
  }else{
    cont.classList.remove("ocultar");
  }
  lastScroll = actual;
});
</script>

</body>
</html>
