<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Categor√≠as de Productos</title>

<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:url('../../images/plata.jpeg') no-repeat center center fixed;
  background-size:cover;
  color:#fff;
}

header{
  background:rgba(35,47,62,.95);
  padding:12px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  position:sticky;
  top:0;
  z-index:9999;
}

header h1{
  margin:0;
  color:#ffcc00;
  font-size:1.6em;
}

nav a{
  color:#fff;
  text-decoration:none;
  padding:.5em 1em;
  background:#ff007f;
  border-radius:10px;
  margin-left:8px;
}

h2{
  text-align:center;
  margin-top:15px;
}

/* ================= CATEGOR√çAS ================= */
.contenedor-categorias{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  margin:1em;
}

.categoria-btn{
  background:#ff007f;
  color:#fff;
  padding:1em 2em;
  border-radius:16px;
  margin:8px;
  border:none;
  font-weight:bold;
  cursor:pointer;
}

/* ================= VIDEO HORIZONTAL ================= */
.video-wrapper{
  width:100%;
  max-width:1400px;
  margin:15px auto;
  display:none;
}

.video-wrapper video{
  width:100%;
  aspect-ratio:16/9;      /* FORZADO HORIZONTAL */
  object-fit:cover;
  border-radius:16px;
  box-shadow:0 6px 20px rgba(0,0,0,.6);
}

/* ================= PRODUCTOS ================= */
#productos-lista{
  display:grid;
  gap:1.2em;
  padding:1.2em;
}

@media(min-width:1200px){
  #productos-lista{grid-template-columns:repeat(4,1fr);}
}
@media(max-width:1199px){
  #productos-lista{grid-template-columns:repeat(2,1fr);}
}
@media(max-width:600px){
  #productos-lista{grid-template-columns:1fr;}
}

.producto{
  background:rgba(255,255,255,.9);
  padding:1em;
  border-radius:14px;
  text-align:center;
  color:#000;
  animation:flotar 3s ease-in-out infinite alternate;
}

@keyframes flotar{
  from{transform:translateY(0)}
  to{transform:translateY(-6px)}
}

.producto img{
  width:100%;
  height:170px;
  object-fit:cover;
  border-radius:10px;
}

.boton{
  display:block;
  margin-top:8px;
  padding:.6em;
  background:#ff5722;
  color:#fff;
  border-radius:8px;
  text-decoration:none;
  font-weight:bold;
  cursor:pointer;
}

footer{
  background:rgba(35,47,62,.95);
  padding:1em;
  text-align:center;
}
</style>
</head>

<body>

<header>
  <h1>DRANGILS MORALES</h1>
  <nav>
    <a href="../../pagina_principal/pagina_principal.html">Inicio</a>
    <a href="../../opciones/vercarrito.html">
      Carrito (<span id="contadorCarrito">0</span>)
    </a>
  </nav>
</header>

<h2 id="titulo-principal">Categor√≠as de Productos</h2>

<div class="contenedor-categorias" id="categoria-container"></div>

<!-- VIDEO PROMOCIONAL -->
<div class="video-wrapper" id="videoWrapper">
  <video id="video-anuncio" autoplay muted playsinline></video>
</div>

<h2 id="titulo-cat" style="display:none;"></h2>

<div id="productos-lista"></div>

<footer>¬© 2025 DRANGILS MORALES</footer>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
/* ======================================================
   JSON DESDE GITHUB (NO TOCAR)
====================================================== */
const URL_JSON =
"https://raw.githubusercontent.com/luismorales2025/APP_2025_DRANGILSMORS./main/data/products.json";

/* ======================================================
   VIDEOS POR CATEGOR√çA
   üîπ EL NOMBRE DEBE SER IGUAL AL "category" DEL JSON
====================================================== */
const videosCategorias = {
  // category: "catalogos"
  catalogos: "../../sanuncio1.mp4",

  // category: "ropa"
  ropa: "../../anuncio1.mp4",

  // category: "accesorios"
  accesorios: "../../anuncio1.mp4",

  // category: "calzado"
  calzado: "../../videos/calzado_horizontal.mp4"
};

let productos = [];
let carrito = JSON.parse(localStorage.getItem("carrito")) || [];

/* ================== CARGAR CATEGOR√çAS ================== */
fetch(URL_JSON)
  .then(r => r.json())
  .then(data => {
    productos = data;

    const categorias = [...new Set(data.map(p => p.category))];

    document.getElementById("categoria-container").innerHTML =
      categorias.map(cat =>
        `<button class="categoria-btn" onclick="mostrarCategoria('${cat}')">
          ${cat}
        </button>`
      ).join("");

    actualizarContador();
  });

/* ================== MOSTRAR CATEGOR√çA ================== */
function mostrarCategoria(cat){
  const video = document.getElementById("video-anuncio");
  const wrapper = document.getElementById("videoWrapper");
  const lista = document.getElementById("productos-lista");
  const titulo = document.getElementById("titulo-cat");

  document.getElementById("titulo-principal").style.display="none";
  document.getElementById("categoria-container").style.display="none";

  titulo.style.display="block";
  titulo.textContent="Categor√≠a: "+cat;
  lista.innerHTML="";

  const mostrarProductos = () => {
    wrapper.style.display="none";

    lista.innerHTML = productos
      .filter(p=>p.category===cat)
      .map(p=>`
        <div class="producto">
          <img src="${p.image}">
          <h3>${p.title}</h3>
          <p><b>Q${p.price}</b></p>

          <button class="boton"
            onclick="agregarCarrito('${p.title}',${p.price})">
            Agregar al carrito
          </button>

          <a class="boton"
            href="../../opciones/descripcion.html?id=${p.id}">
            Ver descripci√≥n
          </a>
        </div>
      `).join("");
  };

  if(videosCategorias[cat]){
    video.src = videosCategorias[cat];
    wrapper.style.display="block";
    video.currentTime = 0;
    video.play();
    video.onended = mostrarProductos;
  } else {
    mostrarProductos();
  }
}

/* ================== CARRITO ================== */
function agregarCarrito(nombre,precio){
  let prod = carrito.find(p=>p.nombre===nombre);
  if(prod) prod.cantidad++;
  else carrito.push({nombre,precio,cantidad:1});

  localStorage.setItem("carrito",JSON.stringify(carrito));
  actualizarContador();

  Swal.fire({
    title:"Producto agregado",
    icon:"success",
    showCancelButton:true,
    confirmButtonText:"Ver carrito",
    cancelButtonText:"Seguir comprando"
  }).then(r=>{
    if(r.isConfirmed){
      window.location.href="../../opciones/vercarrito.html";
    }
  });
}

function actualizarContador(){
  document.getElementById("contadorCarrito").textContent =
    carrito.reduce((a,p)=>a+p.cantidad,0);
}
</script>

</body>
</html>
